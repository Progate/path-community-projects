# HTTP サーバーを実装してみよう

`src/server.ts` には、 Node.js に標準で備わっている `node:http` パッケージを利用したサーバーが実装されています。これを拡張し、 `/public` フォルダの中にあるファイルを返すサーバーを作りましょう。

## まずはコードを確認して実行してみよう

以下の手順に従い、コードを確認して試しに実行してみましょう。

1. `src/server.ts` の中身を軽く読んでみる
2. TypeScript をトランスパイルする
3. `out/server.js` を実行する
    - サーバーは `Ctrl+C`（macOS の場合は `⌘+C`）で終了できます。

## サーバーにアクセスしてみよう

サーバーは `http://localhost:12345` でアクセスができます。サーバーを起動し、以下の方法で動作確認してみましょう。

- ブラウザで [http://localhost:12345](http://localhost:12345/) を開いてみましょう
- `curl` コマンドをつかって `http://localhost:12345` にアクセスしてみましょう
  - このとき、 `-v` オプションをつけることで、`curl` コマンドがサーバーに送信するリクエストヘッダーや、サーバーから `curl` コマンドに返されるレスポンスヘッダーが確認できるので試してみましょう。

また、コードの変更がきちんと反映されるか確かめるために、ステータスコードやレスポンスボディーを変えてみて、再度トランスパイルし直して実行してみましょう。期待通りに変更できたら成功です。

## 満たしたい仕様

今回の課題では、 以下の仕様を満たすサーバーを標準パッケージ `node:http` を利用して実装してください。 `src/server.ts` を編集していって構いません。実装は[フレームワークなしの Node.js サーバ](https://developer.mozilla.org/ja/docs/Learn/Server-side/Node_server_without_framework)を参考にしてください。

- リクエストに URL としてわたってきたパスに対応するファイルを `/public` から探して読み込み、その中身をレスポンスとして返す。
  - 例： `http://localhost:12345/hello.html` にアクセスがあったら、 `/public/hello.html` を返す
- レスポンスは以下の仕様に従う。
  - [ステータスコード](https://developer.mozilla.org/en-US/docs/Web/HTTP/Status)
    - ファイルが存在する場合は 200 、存在しない場合は 404 を設定する。
  - レスポンスヘッダー
    - `*.html` にアクセスする場合は `Content-Type` というヘッダーに `text/html` をつけて返す。
    - `*.jpg` にアクセスする場合は `Content-Type` というヘッダーに `image/jpeg` をつけて返す。
    - `*.json` にアクセスする場合は `Content-Type` というヘッダーに `text/json` をつけて返す。
    - `*.ico` にアクセスする場合は `Content-Type` というヘッダーに `image/x-icon` をつけて返す。
- 環境変数 `PORT` に値があるときはサーバーのポートは設定された値で待ち受ける
  - 値が設定されていないときは `12345` で待ち受ける

## 要件の補足

- `src/server.ts` のトランスパイル出力は `out/server.js` であること

----

仕様を満たせたと判断したら、 `progate submit` コマンドを実行してみてください。
